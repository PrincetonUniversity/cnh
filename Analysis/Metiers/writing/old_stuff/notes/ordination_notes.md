
## Should I do PCA before clustering?

Notes from Legendre & Legendre (2012)

+ "Ordination consists of plotting object-points along an axis representing an ordered relationship, or forming a scatter diagram with two or more axes."
+ Several descriptors are usually observed for each object under study. Looking at scatter plots of the objects with respect to all possibele pairs of descriptors is a tediuous approach, which generally does not shed much light on the problem. In contrast, the multivariate approach consists of representing the scatter objects in a multidimensional diagram, with as many axes as there are descriptors. This is not possible to do in more than 2-3 dimensions on paper, so ecologists project multidimensional scatter diagrams onto bivariate graphs whose axes are known to be of particular interest. The axes of these graphs are chosen to represent a large fraction of the variability of the multidimensional matrix, in a space with reduced dimensionality relative to the original data set. 
+ Ordination in reduced space is often called _factor analysis_ since it is based on the extraction of eigenvectors or _factors_ of the association matrix.+ PCA is limited to quantitative descriptors and because it preserves Euclidean distance, is senstive to double-zeros. 
+ Correspondance analysis (CA) is useful to analyze species presence/absence or abundance data. 
+ PCA, CA and PCoA are eigenvector-based methods, nMDS is not. Canonical analyses ar ealso eigenvector-based are covered seperately. 
+ Ordinations can be used as complements to cluster analyses. Clustering investigates pairwise distances among objects, looking for fine relationships, whereas ordination in reduced space considers the variability of the whole association matrix and thus brings out general gradients. 
+ When only 2-3 dimensions are considered, ordinations in reduced space may misrepresent the structure by projecting together clusters of objects that are distinct in higher dimensions. Clustering methods allow one to seperate clusters whose projections in reduced space sometimes obscure the relationship between them. 
+ Several authors (pg. 523) have independently proposed to take advantage of the characteristics of clustering and ordination by combining the results of the two types of analyses on the same diagram. 
+ It is recommended to represent clustering results onto ordination diagrams. 
+ Drawing single linkage results onto an ordination diagram provides both the correct positions for the main clusters of objects (from ordination) and the fine relationships between closely similar objects (from clustering). It's advised to only draw the primary connections on the ordination diagrame because it reflects the changes in the composition of clusters. Otherwise the groups of highly similar objects may become lost in the multitude of links drawn on ordination. 
+ Because PCA preserves euclidean distance, it's not generally appropriate to analyze raw species data. However the raw specie data can be subjected to PCA after an appropriate pre-transformation 
	+ i.e. should be doing a transformation before PCA and then pass it into a clustering algorithm. this was essentially what I was doing with the frequency data, but not knowing it. however still has the double zero problem that way I think. 

Special attention to heirarchical clustering

+ Agglomerative procedures are the most developed because they are easier to program and that with divisive procedures, erroneous allocation of an object to a cluster at the beginning of the procedure cannot be reversed. 
+ Single linkage clustering results in chaining, and is sensitive to noise in the data because noise changes the distance values and thus may modify the orderin which objects cluster. 
+ Complete linkage agglomeration is when the fusion of two clusters depends on the most distant pair of objects instead of the closest. As a cluster grows, it becomes more difficult for new objects to join. For that reason the growth of a cluster seems to move it away from the other objects or clusters in the analysis. This is the opposite effect from single linkage clustering. Complete linkage produces maximally linked and rather spherical clusters, where single linkage produced elongated clusters with loose chaing. Complete linkage is often desireable in ecology when one wishes to delineate clusters with clear discontinuities. 
+ Downside of complete and intermediate linkage models is that when incompatible candidate objectts present themselves at the same time to be included in a cluster, algorithms use a pre-established and often arbitrary rule, a "right hand rule", to choose one and exclude the other. The problem does not exist in single linkage. 
+ Intermediate linkage attempts to conserve the metric properties of reference space. If the interest is only in the clusters and not the actual links between the clusters, the average clustering methods could be useful because they conserve the metric properties of the reference space. 
+ UPGMA assumes that the objects in each group form a representative sample of a corresponding larger group of objects in the reference population under study. For that reason, UPGMA should only be used in connection with simple random or systematic sampling designs if the results are to be extrapolated to a larger reference population. When the branching pattern of the dendogram displays asymmetry (many more objects in one branch than the other), this can be attributed to the structure of the reference population if the sampling design was random. This is important to link with random/stratefied/representative sampling because when many observations of a given type have been included in the set to be clustered, next to others that are nto well sampled the positions of the centroids may be biased twoards the over-representing types, which could distort the clustering. Weighting  corrects this problem by giving equal weight ot the two clusters on the verge of fusing. 
+ Ward's minimum variane method is related to centroid methods in that it also leads to a geometric representation in which cluster centroids play a key role. The method minimizes an objective funtion. Ward.D2 uses the squared distances instead of distances. The Ward.D method uses distances instead of distances squared in a specific step which does not necessarily mnimize the change in total error, so the clustering does not follow Ward's rule. 
+ Because the Ward method minimizes the sum of within-group sums of squares the clusters tend to be hyperspherical and to contain roughly equal numbers of objects if the observations are evenly distributed through reference space. 
+ WPGMA may give sharper contrast to the classification
+ Unweighted centroid clustering calculates the centroid at each step of the members of a cluster and considers that a new object for the remainder of the clustering procedure. Centroid clustering may lead to reversals.